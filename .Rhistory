label = paste("R-squared =", round(r_squared, 3), "\n", "p-value =", round(p_value, 3)),
size = 4) +
ylab(CESTnetwork) +
xlab(paste(network, "FC")) +
theme(legend.position="bottom",
axis.title.x = element_text(size = 20),
axis.title.y = element_text(size = 20))
plot(gg)
# Save Plot
ggsave("/Users/pecsok/projects/GluCEST-fMRI/glucest-rsfmri/motor_glu_pipeline/figures/SomMot_glu-fc-diag.png",
dpi = 300, width = 12,   height = 7, units = "in")
plot(gg)
dev.off()
print(paste("PSY:", sum(graph_df$diag_group == "PSY")))
print(paste("HC:", sum(graph_df$diag_group == "HC")))
print(summary)
print(summary_hc)
print(summary_psy)
# Subset dataframe
graph_cols <- c(network, 'lagtime_scan', CESTnetwork) # ,'age', 'age', 'sex',
graph_df <- grp_df[complete.cases(grp_df[, graph_cols]), ]
print(nrow(grp_df))
print(nrow(graph_df))
# Make Model
formula_str <- paste(CESTnetwork, " ~ sex +  lagtime_scan + ", network) #sex + lagtime_scan +age +
m1 <- lm(formula_str, data = graph_df)
summary <- summary(m1)
r_squared <- summary(m1)$r.squared
p_value <- summary(m1)$coefficients[2, 4]
print(summary)
# Create plot
gg <- ggplot(graph_df,
aes_string(x = network,
y = CESTnetwork)) + #
geom_point(size=2.75) + #aes(color="purple"
geom_smooth(method = "lm",
formula = y ~ x,
se = FALSE, color="black") +
scale_color_brewer(palette = "PuOr") +
annotate("text", x = Inf, y = -Inf, hjust = 1, vjust = 0,
label = paste("R-squared =", round(r_squared, 3), "\n", "p-value =", round(p_value, 3)),
size = 4) +
ylab(CESTnetwork) +
xlab(paste(network, "FC")) +
theme(legend.position="bottom",
axis.title.x = element_text(size = 20),
axis.title.y = element_text(size = 20))
plot(gg)
# Save Plot
ggsave("/Users/pecsok/projects/GluCEST-fMRI/glucest-rsfmri/motor_glu_pipeline/figures/SomMot_glu-fc.png",
dpi = 300, width = 12,   height = 7, units = "in")
plot(gg)
dev.off()
# Subset dataframe
graph_cols <- c(network, CESTnetwork, 'age', 'lagtime_scan')
graph_df <- grp_df[complete.cases(grp_df[, graph_cols]), ]
# Make Model
m1 <- lm(formula_str, data = graph_df)
summary <- summary(m1)
r_squared <- summary(m1)$r.squared
p_value <- summary(m1)$coefficients[2, 4]
print(summary)
m1_hc <- lm(formula_str, data = graph_df[graph_df$diag_group=='HC',])
summary_hc <- summary(m1_hc)
r_squared_hc <- summary(m1_hc)$r.squared
p_value_hc <- summary(m1_hc)$coefficients[2, 4]
print(summary_hc)
m1_psy <- lm(formula_str, data = graph_df[graph_df$diag_group=='PSY',])
summary_psy <- summary(m1_psy)
r_squared_psy <- summary(m1_psy)$r.squared
p_value_psy <- summary(m1_psy)$coefficients[2, 4]
print(summary_psy)
# Create plot
gg <- ggplot(graph_df,
aes_string(x = network,
y = CESTnetwork, color='diag_group')) +
geom_point(size=2.75) + #aes(color="purple"
geom_smooth(method = "lm",
formula = y ~ x,
se = FALSE) + #, color="black"
#scale_color_brewer(palette = "PuOr") +
annotate("text", x = Inf, y = -Inf, hjust = 1, vjust = 0,
label = paste("R-squared =", round(r_squared, 3), "\n", "p-value =", round(p_value, 3)),
size = 4) +
ylab(CESTnetwork) +
xlab(paste(network, "FC")) +
theme(legend.position="bottom",
axis.title.x = element_text(size = 20),
axis.title.y = element_text(size = 20))
plot(gg)
# Save Plot
ggsave("/Users/pecsok/projects/GluCEST-fMRI/glucest-rsfmri/motor_glu_pipeline/figures/SomMot_glu-fc-diag.png",
dpi = 300, width = 12,   height = 7, units = "in")
plot(gg)
dev.off()
print(paste("PSY:", sum(graph_df$diag_group == "PSY")))
print(paste("HC:", sum(graph_df$diag_group == "HC")))
print(summary)
print(summary_hc)
print(summary_psy)
# Subset grp_df and exclude tapping outliers:
graph_cols <- c(network, 'tap_tot', CESTnetwork, 'age', 'lagtime_scan')
graph_df <- grp_df[complete.cases(grp_df[, graph_cols]), ]
#graph_df <- graph_df[!(graph_df$BBLID=="80557"),] # tap_tot<75
#graph_df <- graph_df[!(graph_df$BBLID=="94703"),] # tap_tot>125
#graph_df <- graph_df[!(graph_df$BBLID=="127935"),] # tap_tot>125
#graph_df <- graph_df[!(graph_df$BBLID=="119791"),] # tap_tot>125
#graph_df <- graph_df[!(graph_df$BBLID=="128865"),] # cest-fc ratio high
graph_df <- graph_df[!(graph_df$BBLID=="128259"),]
# Make Model
formula_str <- paste("tap_tot ~  cest_fc_res * diag_group") #age + sex + lagtime_CNB + `lagtime_CNB-fc` +
m1 <- lm(formula_str, data = graph_df)
summary <- summary(m1)
r_squared <- summary(m1)$r.squared
p_value <- summary(m1)$coefficients[4, 4]
print(summary)
# Plot
gg <- ggplot(graph_df,
aes_string(x = 'cest_fc',
y = 'tap_tot', color='diag_group')) + #
geom_point(size=2.75, shape=15) + #aes(color=treatment)
geom_smooth(method = "lm",
formula = y~x,
se = FALSE) +
annotate("text", x = Inf, y = -Inf, hjust = 1, vjust = 0,
label = paste("R-squared =", round(r_squared, 3), "\n", "p-value =", round(p_value, 3)),
size = 4) +
ylab("Tapping Score") +
xlab(paste("GluCEST-FC Ratio")) +
theme(legend.position="bottom",
axis.title.x = element_text(size = 20),
axis.title.y = element_text(size = 20))
plot(gg)
ggsave("/Users/pecsok/projects/GluCEST-fMRI/glucest-rsfmri/motor_glu_pipeline/figures/Tapping_SomMot_glu-fc_diag.png",
dpi = 300, width = 12,   height = 7, units = "in")
dev.off()
print(paste("PSY:", sum(graph_df$diag_group == "PSY")))
print(paste("HC:", sum(graph_df$diag_group == "HC")))
print(summary)
# Subset grp_df and exclude tapping outliers:
graph_cols <- c(network, 'tap_tot', CESTnetwork, 'age', 'lagtime_scan')
graph_df <- grp_df[complete.cases(grp_df[, graph_cols]), ]
#graph_df <- graph_df[!(graph_df$BBLID=="80557"),] # tap_tot<75
#graph_df <- graph_df[!(graph_df$BBLID=="94703"),] # tap_tot>125
#graph_df <- graph_df[!(graph_df$BBLID=="127935"),] # tap_tot>125
#graph_df <- graph_df[!(graph_df$BBLID=="119791"),] # tap_tot>125
#graph_df <- graph_df[!(graph_df$BBLID=="128865"),] # cest-fc ratio high
graph_df <- graph_df[!(graph_df$BBLID=="128259"),]
# Make Model
formula_str <- paste("tap_tot ~ sex +  cest_fc_res * diag_group") #age + lagtime_CNB + `lagtime_CNB-fc` +
m1 <- lm(formula_str, data = graph_df)
summary <- summary(m1)
r_squared <- summary(m1)$r.squared
p_value <- summary(m1)$coefficients[4, 4]
print(summary)
# Plot
gg <- ggplot(graph_df,
aes_string(x = 'cest_fc',
y = 'tap_tot', color='diag_group')) + #
geom_point(size=2.75, shape=15) + #aes(color=treatment)
geom_smooth(method = "lm",
formula = y~x,
se = FALSE) +
annotate("text", x = Inf, y = -Inf, hjust = 1, vjust = 0,
label = paste("R-squared =", round(r_squared, 3), "\n", "p-value =", round(p_value, 3)),
size = 4) +
ylab("Tapping Score") +
xlab(paste("GluCEST-FC Ratio")) +
theme(legend.position="bottom",
axis.title.x = element_text(size = 20),
axis.title.y = element_text(size = 20))
plot(gg)
ggsave("/Users/pecsok/projects/GluCEST-fMRI/glucest-rsfmri/motor_glu_pipeline/figures/Tapping_SomMot_glu-fc_diag.png",
dpi = 300, width = 12,   height = 7, units = "in")
dev.off()
print(paste("PSY:", sum(graph_df$diag_group == "PSY")))
print(paste("HC:", sum(graph_df$diag_group == "HC")))
print(summary)
# Subset grp_df and exclude tapping outliers:
graph_cols <- c(network, 'tap_tot', CESTnetwork, 'age', 'lagtime_scan')
graph_df <- grp_df[complete.cases(grp_df[, graph_cols]), ]
#graph_df <- graph_df[!(graph_df$BBLID=="80557"),] # tap_tot<75
#graph_df <- graph_df[!(graph_df$BBLID=="94703"),] # tap_tot>125
#graph_df <- graph_df[!(graph_df$BBLID=="127935"),] # tap_tot>125
#graph_df <- graph_df[!(graph_df$BBLID=="119791"),] # tap_tot>125
#graph_df <- graph_df[!(graph_df$BBLID=="128865"),] # cest-fc ratio high
graph_df <- graph_df[!(graph_df$BBLID=="128259"),]
# Make Model
formula_str <- paste("tap_tot ~ lagtime_CNB + `lagtime_CNB-fc` + cest_fc_res * diag_group") #age +  +
m1 <- lm(formula_str, data = graph_df)
summary <- summary(m1)
r_squared <- summary(m1)$r.squared
p_value <- summary(m1)$coefficients[4, 4]
print(summary)
# Plot
gg <- ggplot(graph_df,
aes_string(x = 'cest_fc',
y = 'tap_tot', color='diag_group')) + #
geom_point(size=2.75, shape=15) + #aes(color=treatment)
geom_smooth(method = "lm",
formula = y~x,
se = FALSE) +
annotate("text", x = Inf, y = -Inf, hjust = 1, vjust = 0,
label = paste("R-squared =", round(r_squared, 3), "\n", "p-value =", round(p_value, 3)),
size = 4) +
ylab("Tapping Score") +
xlab(paste("GluCEST-FC Ratio")) +
theme(legend.position="bottom",
axis.title.x = element_text(size = 20),
axis.title.y = element_text(size = 20))
plot(gg)
ggsave("/Users/pecsok/projects/GluCEST-fMRI/glucest-rsfmri/motor_glu_pipeline/figures/Tapping_SomMot_glu-fc_diag.png",
dpi = 300, width = 12,   height = 7, units = "in")
dev.off()
print(paste("PSY:", sum(graph_df$diag_group == "PSY")))
print(paste("HC:", sum(graph_df$diag_group == "HC")))
# Subset grp_df and exclude tapping outliers:
graph_cols <- c(network, 'tap_tot', CESTnetwork, 'age', 'lagtime_scan')
graph_df <- grp_df[complete.cases(grp_df[, graph_cols]), ]
#graph_df <- graph_df[!(graph_df$BBLID=="80557"),] # tap_tot<75
#graph_df <- graph_df[!(graph_df$BBLID=="94703"),] # tap_tot>125
#graph_df <- graph_df[!(graph_df$BBLID=="127935"),] # tap_tot>125
#graph_df <- graph_df[!(graph_df$BBLID=="119791"),] # tap_tot>125
#graph_df <- graph_df[!(graph_df$BBLID=="128865"),] # cest-fc ratio high
graph_df <- graph_df[!(graph_df$BBLID=="128259"),]
# Make Model
formula_str <- paste("tap_tot ~ sex + lagtime_CNB + `lagtime_CNB-fc` + cest_fc_res * diag_group") #age +  +
m1 <- lm(formula_str, data = graph_df)
summary <- summary(m1)
r_squared <- summary(m1)$r.squared
p_value <- summary(m1)$coefficients[4, 4]
print(summary)
# Plot
gg <- ggplot(graph_df,
aes_string(x = 'cest_fc',
y = 'tap_tot', color='diag_group')) + #
geom_point(size=2.75, shape=15) + #aes(color=treatment)
geom_smooth(method = "lm",
formula = y~x,
se = FALSE) +
annotate("text", x = Inf, y = -Inf, hjust = 1, vjust = 0,
label = paste("R-squared =", round(r_squared, 3), "\n", "p-value =", round(p_value, 3)),
size = 4) +
ylab("Tapping Score") +
xlab(paste("GluCEST-FC Ratio")) +
theme(legend.position="bottom",
axis.title.x = element_text(size = 20),
axis.title.y = element_text(size = 20))
plot(gg)
ggsave("/Users/pecsok/projects/GluCEST-fMRI/glucest-rsfmri/motor_glu_pipeline/figures/Tapping_SomMot_glu-fc_diag.png",
dpi = 300, width = 12,   height = 7, units = "in")
dev.off()
print(paste("PSY:", sum(graph_df$diag_group == "PSY")))
print(paste("HC:", sum(graph_df$diag_group == "HC")))
knitr::opts_chunk$set(echo = FALSE,
#   out.width="49%",
#   out.height="49%",
fig.show='hold')
#   fig.align='center')
library(dplyr)
library(tidyverse)
library(ggplot2)
library(ggpmisc)
library(cowplot)
library(pls)
source("~/projects/GluCEST-fMRI/glucest-rsfmri/read_grp_data.R")
#source("/cbica/projects/thalamocortical_development/software/rotate_parcellation/R/perm.sphere.p.R") This package is used for parcel-based spin testing.
#https://www.middleprofessor.com/files/applied-biostatistics_bookdown/_book/adding-covariates-to-a-linear-model
# Markdown help:
# https://bookdown.org/yihui/rmarkdown-cookbook/figures-side.html#fig:figures-side
# Make Models, generate and save residuals
# CEST
formula_str <- paste(CESTnetwork, " ~ age ")
cest_age <- lm(formula_str, data = grp_df)
grp_df$'CEST_residuals' <- residuals(cest_age)
print(summary(cest_age))
# FC
formula_str <- paste(network, " ~ age ")
fc_age <- lm(formula_str, data = grp_df)
grp_df$'FC_residuals' <- residuals(fc_age)
print(summary(fc_age))
# CEST-FC Ratio on residuals
grp_df$'cest_fc_res' <- grp_df$CEST_residuals/grp_df$FC_residuals
grp_df$'cest_fc_res' <- scale(grp_df$'cest_fc_res')
CESTnetwork <- 'CEST_residuals'
network <- 'FC_residuals'
# Subset dataframe
graph_cols <- c(network, 'age', CESTnetwork) # ,'age', 'age', 'sex',
graph_df <- grp_df[complete.cases(grp_df[, graph_cols]), ]
print(nrow(grp_df))
print(nrow(graph_df))
# Make Model
formula_str <- paste(CESTnetwork, " ~ ", network) #sex + lagtime_scan +age + , "+ lagtime_scan"
m1 <- lm(formula_str, data = graph_df)
summary <- summary(m1)
r_squared <- summary(m1)$r.squared
p_value <- summary(m1)$coefficients[2, 4]
print(summary)
# Create plot
gg <- ggplot(graph_df,
aes_string(x = 'age',
y = 'avgCEST_SomMot', color='diag_group')) + #
geom_point(size=2.75) + #aes(color="purple"
geom_smooth(method = "lm",
formula = y ~ x,
se = FALSE) +
scale_color_brewer(palette = "PuOr") +
annotate("text", x = Inf, y = -Inf, hjust = 1, vjust = 0,
label = paste("R-squared =", round(r_squared, 3), "\n", "p-value =", round(p_value, 3)),
size = 4) +
ylab('CEST ') +
xlab('Age') +
theme(legend.position="bottom",
axis.title.x = element_text(size = 20),
axis.title.y = element_text(size = 20))
plot(gg)
# Make Models, generate and save residuals
# CEST
formula_str <- paste(CESTnetwork, " ~ age ")
cest_age <- lm(formula_str, data = grp_df)
grp_df$'CEST_residuals' <- residuals(cest_age)
print(summary(cest_age))
cest_age_hc <- lm(formula_str, data = graph_df[graph_df$diag_group=='HC',])
print(summary(cest_age_hc))
cest_age_psy <- lm(formula_str, data = graph_df[graph_df$diag_group=='PSY',])
print(summary(cest_age_psy))
# FC
formula_str <- paste(network, " ~ age ")
fc_age <- lm(formula_str, data = grp_df)
grp_df$'FC_residuals' <- residuals(fc_age)
print(summary(fc_age))
fc_age_hc <- lm(formula_str, data = graph_df[graph_df$diag_group=='HC',])
print(summary(fc_age_hc))
fc_age_psy <- lm(formula_str, data = graph_df[graph_df$diag_group=='PSY',])
print(summary(fc_age_psy))
# CEST-FC Ratio on residuals
grp_df$'cest_fc_res' <- grp_df$CEST_residuals/grp_df$FC_residuals
grp_df$'cest_fc_res' <- scale(grp_df$'cest_fc_res')
CESTnetwork <- 'CEST_residuals'
network <- 'FC_residuals'
# Subset dataframe
graph_cols <- c(network, 'age', CESTnetwork) # ,'age', 'age', 'sex',
graph_df <- grp_df[complete.cases(grp_df[, graph_cols]), ]
# Create age-cest plot
gg <- ggplot(graph_df,
aes_string(x = 'age',
y = 'avgCEST_SomMot', color='diag_group')) + #
geom_point(size=2.75) + #aes(color="purple"
geom_smooth(method = "lm",
formula = y ~ x,
se = FALSE) +
scale_color_brewer(palette = "PuOr") +
annotate("text", x = Inf, y = -Inf, hjust = 1, vjust = 0,
label = paste("R-squared =", round(r_squared, 3), "\n", "p-value =", round(p_value, 3)),
size = 4) +
ylab('CEST ') +
xlab('Age') +
theme(legend.position="bottom",
axis.title.x = element_text(size = 20),
axis.title.y = element_text(size = 20))
plot(gg)
# Create age-fc plot
gg2 <- ggplot(graph_df,
aes_string(x = 'age',
y = 'SomMot', color='diag_group')) + #
geom_point(size=2.75) + #aes(color="purple"
geom_smooth(method = "lm",
formula = y ~ x,
se = FALSE) +
scale_color_brewer(palette = "PuOr") +
annotate("text", x = Inf, y = -Inf, hjust = 1, vjust = 0,
label = paste("R-squared =", round(r_squared, 3), "\n", "p-value =", round(p_value, 3)),
size = 4) +
ylab('SomMot FC') +
xlab('Age') +
theme(legend.position="bottom",
axis.title.x = element_text(size = 20),
axis.title.y = element_text(size = 20))
plot(gg2)
formula_str <- paste(CESTnetwork, " ~ age ")
cest_age <- lm(formula_str, data = grp_df)
grp_df$'CEST_residuals' <- residuals(cest_age)
print(summary(cest_age))
cest_age_hc <- lm(formula_str, data = graph_df[graph_df$diag_group=='HC',])
print(summary(cest_age_hc))
cest_age_psy <- lm(formula_str, data = graph_df[graph_df$diag_group=='PSY',])
print(summary(cest_age_psy))
formula_str <- paste(network, " ~ age ")
fc_age <- lm(formula_str, data = grp_df)
grp_df$'FC_residuals' <- residuals(fc_age)
print(summary(fc_age))
fc_age_hc <- lm(formula_str, data = graph_df[graph_df$diag_group=='HC',])
print(summary(fc_age_hc))
fc_age_psy <- lm(formula_str, data = graph_df[graph_df$diag_group=='PSY',])
print(summary(fc_age_psy))
# FC
formula_str <- paste(network, " ~ age ")
fc_age <- lm(formula_str, data = grp_df)
grp_df$'FC_residuals' <- residuals(fc_age)
print(summary(fc_age))
library(ggplot2)
#rm(list = ls())
knitr::opts_chunk$set(echo = FALSE,
#   out.width="49%",
#   out.height="49%",
fig.show='hold')
#   fig.align='center')
library(dplyr)
library(tidyverse)
library(ggplot2)
library(ggpmisc)
library(cowplot)
library(pls)
source("~/projects/GluCEST-fMRI/glucest-rsfmri/read_grp_data.R")
#source("/cbica/projects/thalamocortical_development/software/rotate_parcellation/R/perm.sphere.p.R") This package is used for parcel-based spin testing.
#https://www.middleprofessor.com/files/applied-biostatistics_bookdown/_book/adding-covariates-to-a-linear-model
# Markdown help:
# https://bookdown.org/yihui/rmarkdown-cookbook/figures-side.html#fig:figures-side
setwd("/Users/pecsok/projects/GluCEST-fMRI/glucest-rsfmri/")
# Set fieldstrength and read in group data:
cestmat <- read.csv('/Users/pecsok/projects/GluCEST-fMRI/glucest-rsfmri/fmri_pipeline/cest_parcelmat_3T.csv')
fcmat <- read.csv('/Users/pecsok/projects/GluCEST-fMRI/glucest-rsfmri/fmri_pipeline/fc_parcelmat_3T.csv')
rm(list = ls())
rm(list = ls())
knitr::opts_chunk$set(echo = FALSE,
#   out.width="49%",
#   out.height="49%",
fig.show='hold')
#   fig.align='center')
library(dplyr)
library(tidyverse)
library(ggplot2)
library(ggpmisc)
library(cowplot)
library(pls)
source("~/projects/GluCEST-fMRI/glucest-rsfmri/read_grp_data.R")
#source("/cbica/projects/thalamocortical_development/software/rotate_parcellation/R/perm.sphere.p.R") This package is used for parcel-based spin testing.
#https://www.middleprofessor.com/files/applied-biostatistics_bookdown/_book/adding-covariates-to-a-linear-model
# Markdown help:
# https://bookdown.org/yihui/rmarkdown-cookbook/figures-side.html#fig:figures-side
setwd("/Users/pecsok/projects/GluCEST-fMRI/glucest-rsfmri/")
# Set fieldstrength and read in group data:
cestmat <- read.csv('/Users/pecsok/projects/GluCEST-fMRI/glucest-rsfmri/fmri_pipeline/cest_parcelmat_3T.csv')
fcmat <- read.csv('/Users/pecsok/projects/GluCEST-fMRI/glucest-rsfmri/fmri_pipeline/fc_parcelmat_3T.csv')
View(fcmat)
cestmat <- cestmat[1:86,]
fcmat <- fcmat[1:86,]
View(cestmat)
# Keep only cest rows that have >50 cest count
# ADD
# Make df with just mean data
cestdf <- cestmat[,c("NZMean_52","NZMean_54","NZMean_55","NZMean_56","NZMean_60","NZMean_69","NZMean_73","NZMean_74","NZMean_77","NZMean_78","NZMean_87","NZMean_88","NZMean_91","NZMean_92","NZMean_93","NZMean_96")]
fcdf <- fcmat[,c("X52","X54","X55","X56","X60","X69","X73","X74","X77","X78","X87","X88","X91","X92","X93","X96")]
cor(cestdf,fcdf)
class(cestdf)
class(cestdf$NZMean_52)
cor(cestdf,fcdf, use= "complete.obs")
for i in c("52","54","55","56","60","69","73","74","77","78","87","88","91","92","93","96") {
for (i in c("52","54","55","56","60","69","73","74","77","78","87","88","91","92","93","96")) {
print(i)
}
fc_col = paste("X", i)
print(fc_col)
for (i in c("52","54","55","56","60","69","73","74","77","78","87","88","91","92","93","96")) {
fc_col = paste("X", i)
print(fc_col)
}
print(cor(cestdf$cest_col,fcdf$fc_col, use= "complete.obs"))
for (i in c("52","54","55","56","60","69","73","74","77","78","87","88","91","92","93","96")) {
fc_col = paste("X", i, sep = "")
cest_col = paste("NZMean_", i, sep = "")
print(cor(cestdf$cest_col,fcdf$fc_col, use= "complete.obs"))
}
# print(cor(cestdf$cest_col,fcdf$fc_col, use= "complete.obs"))
}
for (i in c("52","54","55","56","60","69","73","74","77","78","87","88","91","92","93","96")) {
fc_col = paste("X", i, sep = "")
cest_col = paste("NZMean_", i, sep = "")
print(cestdf$cest_col)
# print(cor(cestdf$cest_col,fcdf$fc_col, use= "complete.obs"))
}
# Keep only cest rows that have >50 cest count
# ADD
# Make dfs with just mean data
cestdf <- cestmat[,c("NZMean_52","NZMean_54","NZMean_55","NZMean_56","NZMean_60","NZMean_69","NZMean_73","NZMean_74","NZMean_77","NZMean_78","NZMean_87","NZMean_88","NZMean_91","NZMean_92","NZMean_93","NZMean_96")]
fcdf <- fcmat[,c("X52","X54","X55","X56","X60","X69","X73","X74","X77","X78","X87","X88","X91","X92","X93","X96")]
#cor(cestdf,fcdf, use= "complete.obs")
for (i in c("52","54","55","56","60","69","73","74","77","78","87","88","91","92","93","96")) {
fc_col = paste("X", i, sep = "")
cest_col = paste("NZMean_", i, sep = "")
print(cestdf$cest_col)
# print(cor(cestdf$cest_col,fcdf$fc_col, use= "complete.obs"))
}
View(cestmat)
print(cestdf)
# Make dfs with just mean data
cestdf <- cestmat[,c("NZMean_52","NZMean_54","NZMean_55","NZMean_56","NZMean_60","NZMean_69","NZMean_73","NZMean_74","NZMean_77","NZMean_78","NZMean_87","NZMean_88","NZMean_91","NZMean_92","NZMean_93","NZMean_96")]
fcdf <- fcmat[,c("X52","X54","X55","X56","X60","X69","X73","X74","X77","X78","X87","X88","X91","X92","X93","X96")]
print(cestdf)
print(cestdf)
for (i in c("52","54","55","56","60","69","73","74","77","78","87","88","91","92","93","96")) {
fc_col = paste("X", i, sep = "")
cest_col = paste("NZMean_", i, sep = "")
print(cestdf$cest_col)
# print(cor(cestdf$cest_col,fcdf$fc_col, use= "complete.obs"))
}
for (i in c("52","54","55","56","60","69","73","74","77","78","87","88","91","92","93","96")) {
fc_col = paste("X", i, sep = "")
cest_col = paste("NZMean_", i, sep = "")
print(cestdf$cest_col)
# print(cor(cestdf$cest_col,fcdf$fc_col, use= "complete.obs"))
}
